<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>YouTube Watch Later List</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <h1>Watch Later</h1>

    <div class="controls">
        <button id="btnAll" class="active">All</button>
        <button id="btnUnwatched">Unwatched</button>
        <button id="btnWatched">Watched</button>
        <span id="count" class="muted"></span>
    </div>

    <div>
        <button onclick="document.location='sudoku.html'">
            Sudoku Section
        </button>
    </div>

    <table>
        <thead>
            <tr>
                <th class="thumb">Thumbnail</th>
                <th>Title</th>
                <th>Channel</th>
                <th>Link</th>
            </tr>
        </thead>
        <tbody id="rows"></tbody>
    </table>

    <script src="main.js"></script>


    <script>
        const rowsEl = document.getElementById('rows');
        const countEl = document.getElementById('count');
        const btnAll = document.getElementById('btnAll');
        const btnUnwatched = document.getElementById('btnUnwatched');
        const btnWatched = document.getElementById('btnWatched');

        const controller = window.createVideoTableController({
            rowsEl,
            countEl,
            btnAll,
            btnUnwatched,
            btnWatched,
        });

        // Load both watch later and watch history
        const wlP = fetch('data/detailed-watch-later.json?ts=' + Date.now()).then(r => r.json());
        const whP = fetch('data/watched_ids.json?ts=' + Date.now()).then(r => r.json());

        Promise.all([wlP, whP])
            .then(([wl, watchedIds]) => {
                controller.setData(wl, watchedIds);

                // initial render
                controller.render();
            })
            .catch(err => {
                rowsEl.innerHTML = `<tr><td colspan="5">Failed to load data: ${err}</td></tr>`;
            });
    </script>