<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Better Youtube</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">

</head>

<body>

    <h1>Sudoku</h1>

    <div>
        <button onclick="document.location='index.html'">
            Watch Later
        </button>
    </div>

    <div class="controls">
        <button id="btnAll" class="active">All</button>
        <button id="btnUnwatched">Unwatched</button>
        <button id="btnWatched">Watched</button>
        <!--
        <button id="btnMax">Max Duration</button>
        <button id="btnMin">Min Duration</button>
        -->

        <span id="count" class="muted"></span>

    </div>

    <div class="duration-controls">
        <strong>Duration filter (minutes):</strong>

        <label>
            Min
            <input type="range" id="rangeMin" min="0" max="120" value="0" step="1">
            <span id="labelMin">0</span>
        </label>

        <label>
            Max
            <input type="range" id="rangeMax" min="0" max="120" value="120" step="1">
            <span id="labelMax">120</span>
        </label>

        <button id="btnDurReset" type="button">Reset</button>
    </div>


    <table>
        <thead>
            <tr>
                <th class="thumb">Thumbnail</th>
                <th>Title</th>
                <th>Duration</th>
                <th>Channel</th>
                <th>Link</th>
            </tr>
        </thead>
        <tbody id="rows"></tbody>
    </table>


    <script src="main.js"></script>

    <script>
        const rowsEl = document.getElementById('rows');
        const countEl = document.getElementById('count');
        const btnAll = document.getElementById('btnAll');
        const btnUnwatched = document.getElementById('btnUnwatched');
        const btnWatched = document.getElementById('btnWatched');

        const controller = window.createVideoTableController({
            rowsEl,
            countEl,
            btnAll,
            btnUnwatched,
            btnWatched,
        });

        // Page specific data
        const wlP = fetch('data/sudoku-uploads.json?ts=' + Date.now()).then(r => r.json());
        const whP = fetch('data/watched_ids.json?ts=' + Date.now()).then(r => r.json());

        Promise.all([wlP, whP])
            .then(([wl, watchedIds]) => {
                controller.setData(wl, watchedIds);

                // setup duration slider (also from main.js)
                const slider = window.initDurationSlider(() => controller.render());
                slider.configureFromData(wl);
                controller.setDurationSlider(slider);

                // initial render
                controller.render();
            })
            .catch(err => {
                rowsEl.innerHTML = `<tr><td colspan="5">Failed to load data: ${err}</td></tr>`;
            });
    </script>